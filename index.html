<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Guider Mood to Verse</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Amiri&family=Jomhuria&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <style>
    :root { --dark-green:#013220; --darker-green:#002110; --cream:#f5f1e8; --font-base:1rem; }
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    body{
      position:relative;
      font-family:'Roboto',sans-serif;
      font-size:var(--font-base);
      background:linear-gradient(135deg,var(--dark-green),var(--darker-green));
      color:var(--cream);
      display:flex;flex-direction:column;align-items:center;
      min-height:100vh;overflow-x:hidden;
    }
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;}
    header.header{
      width:100%;padding:1rem;text-align:center;font-size:2rem;font-weight:700;letter-spacing:.2rem;
      background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);
      box-shadow:0 4px 12px rgba(0,0,0,0.3);margin-bottom:2rem;
    }
    main.container{
      width:100%;max-width:500px;
      background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);
      border:1px solid rgba(255,255,255,0.2);border-radius:1rem;
      padding:2rem;text-align:center;box-shadow:0 8px 32px rgba(0,0,0,0.3);
      position:relative;z-index:1;
    }
    h1{margin-bottom:1.5rem;font-size:1.75rem;}
    label{display:block;margin-bottom:.5rem;font-weight:700;}
    select{
      width:100%;padding:.75rem;border:none;border-radius:.5rem;font-size:1rem;margin-bottom:1rem;
    }
    button#getVerse{
      background-color:var(--cream);color:var(--dark-green);
      border:none;border-radius:.5rem;padding:.75rem 2rem;
      font-size:1rem;cursor:pointer;transition:transform .2s;margin-bottom:1.5rem;
    }
    button#getVerse:hover{transform:scale(1.05);}
    .verses{display:none;flex-direction:column;gap:1.5rem;}
    .verse-block{
      background:rgba(255,255,255,0.05);border-radius:.75rem;padding:1rem;position:relative;outline:none;
    }
    .verse-block::before{
      content:attr(data-lang-label);
      position:absolute;top:-.75rem;left:1rem;
      background:var(--cream);color:var(--dark-green);
      padding:.25rem .5rem;border-radius:.5rem;font-size:.875rem;font-weight:700;
    }
    .verse-text{font-size:1rem;line-height:1.5;margin-top:.5rem;}
    .play-btn{
      position:absolute;top:.75rem;right:1rem;background:none;
      border:none;cursor:pointer;font-size:1.25rem;
    }

    /* Emoji container */
    #emojiContainer{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;overflow:hidden;z-index:0;}
    .emoji{position:absolute;font-size:2rem;animation:floatUp 3s ease-out forwards;}
    @keyframes floatUp{0%{transform:translateY(0) scale(1);opacity:1;}100%{transform:translateY(-200px) scale(1.5);opacity:0;}}

    @media(min-width:600px){
      h1{font-size:2rem;}
      .verse-text{font-size:1.125rem;}
    }
  </style>
</head>
<body>
  <header class="header">GUIDER</header>
  <main class="container" role="main">
    <h1>Discover Your Verse</h1>
    <label for="mood">Select Your Mood:</label>
    <select id="mood" aria-label="Select your mood">
      <option value="" disabled selected hidden>Choose your mood</option>
      <option value="sad">Sad</option>
      <option value="depressed">Depressed</option>
      <option value="anxious">Anxious</option>
      <option value="angry">Angry</option>
      <option value="stressed">Stressed</option>
      <option value="hopeful">Hopeful</option>
      <option value="happy">Happy</option>
    </select>
    <button id="getVerse">Get Verse</button>
    <div class="verses animate__animated" id="versesContainer" aria-live="polite"></div>
  </main>
  <div id="emojiContainer"></div>

  <script>
    // 1) Verse data
    const mappings = {
      sad:       [{ ar:'Ø¥ÙÙ†ÙÙ‘ Ù…ÙØ¹Ù Ø§Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙŠÙØ³Ù’Ø±Ù‹Ø§', ur:'Ø¨Û’ Ø´Ú© ÛØ± ØªÙ†Ú¯ÛŒ Ú©Û’ Ø³Ø§ØªÚ¾ Ø¢Ø³Ø§Ù†ÛŒ ÛÛ’', en:'Indeed, with hardship [will be] ease.' }],
      depressed: [{ ar:'ÙÙØ¥ÙÙ†ÙÙ‘ Ù…ÙØ¹Ù Ø§Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙŠÙØ³Ù’Ø±Ù‹Ø§', ur:'ØªÙˆ Ø¨Û’ Ø´Ú© ØªÙ†Ú¯ÛŒ Ú©Û’ Ø³Ø§ØªÚ¾ Ø¢Ø³Ø§Ù†ÛŒ ÛÛ’', en:'So verily, with the hardship, there is relief.' }],
      anxious:   [{ ar:'Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø¢Ù…ÙÙ†ÙÙˆØ§ ÙˆÙØªÙØ·Ù’Ù…ÙØ¦ÙÙ†ÙÙ‘ Ù‚ÙÙ„ÙÙˆØ¨ÙÙ‡ÙÙ… Ø¨ÙØ°ÙÙƒÙ’Ø±Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù', ur:'ÙˆÛ Ù„ÙˆÚ¯ Ø¬Ùˆ Ø§ÛŒÙ…Ø§Ù† Ù„Ø§Ø¦Û’ Ø§ÙˆØ± Ø¬Ù† Ú©Û’ Ø¯Ù„ Ø§Ù„Ù„Û Ú©Û’ Ø°Ú©Ø± Ø³Û’ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ù¾Ø°ÛŒØ± ÛÙˆØªÛ’ ÛÛŒÚº', en:'Those who have believed and whose hearts are assured by the remembrance of Allah.' }],
      angry:     [{ ar:'ÙˆÙÙ„ÙØ§ ÙŠÙØ­Ù’Ø³ÙØ¨ÙÙ†ÙÙ‘ Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù ÙŠÙØ³ÙØ§Ø±ÙØ¹ÙÙˆÙ†Ù ÙÙÙŠ Ø§Ù„Ù’ÙƒÙÙÙ’Ø±Ù', ur:'Ø§ÙˆØ± Ø¬Ùˆ Ù„ÙˆÚ¯ Ú©ÙØ± Ù…ÛŒÚº Ø¬Ù„Ø¯ÛŒ Ú©Ø±ØªÛ’ ÛÛŒÚº ÙˆÛ Ù†Û Ø³Ù…Ø¬Ú¾ÛŒÚº', en:'And do not let the hatred of a people prevent you from being just.' }],
      stressed:  [{ ar:'ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø®ÙÙ„ÙÙ‚Ù Ø§Ù„Ø³ÙÙ‘Ù…ÙØ§ÙˆÙØ§ØªÙ ÙˆÙØ§Ù„Ù’Ø£ÙØ±Ù’Ø¶Ù', ur:'ÙˆÛÛŒ Ø®Ø¯Ø§ ÛÛ’ Ø¬Ø³ Ù†Û’ Ø¢Ø³Ù…Ø§Ù†ÙˆÚº Ø§ÙˆØ± Ø²Ù…ÛŒÙ† Ú©Ùˆ Ù¾ÛŒØ¯Ø§ Ú©ÛŒØ§', en:'It is He who created the heavens and the earth.' }],
      hopeful:   [{ ar:'ÙˆÙÙ…ÙÙ† ÙŠÙØªÙÙ‘Ù‚Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙŠÙØ¬Ù’Ø¹ÙÙ„ Ù„ÙÙ‘Ù‡Ù Ù…ÙØ®Ù’Ø±ÙØ¬Ù‹Ø§', ur:'Ø§ÙˆØ± Ø¬Ùˆ Ø§Ù„Ù„Û Ø³Û’ ÚˆØ±Û’ Ú¯Ø§ Ø§Ù„Ù„Û Ø§Ø³ Ú©Û’ Ù„ÛŒÛ’ Ù†Ú©Ø§Ù„Ù†Û’ Ú©Ø§ Ø±Ø§Ø³ØªÛ Ù†Ú©Ø§Ù„ Ø¯Û’Ú¯Ø§', en:'And whosoever fears Allah... He will make for him a way out.' }],
      happy:     [{ ar:'ÙˆÙÙ…ÙÙ† ÙŠÙØªÙÙˆÙÙƒÙÙ‘Ù„Ù’ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙÙÙ‡ÙÙˆÙ Ø­ÙØ³Ù’Ø¨ÙÙ‡Ù', ur:'Ø§ÙˆØ± Ø¬Ùˆ Ø§Ù„Ù„Û Ù¾Ø± Ø¨Ú¾Ø±ÙˆØ³Û Ú©Ø±Û’ØŒ Ø§Ù„Ù„Û Ø§Ø³ Ú©Û’ Ù„Ø¦Û’ Ú©Ø§ÙÛŒ ÛÛ’', en:'And whoever relies upon Allah â€“ then He is sufficient for him.' }]
    };

    // 2) Emoji data & helper
    const moodEmojis = { sad:'ğŸ˜¢', depressed:'ğŸ˜', anxious:'ğŸ˜Ÿ', angry:'ğŸ˜ ', stressed:'ğŸ˜«', hopeful:'ğŸ˜Š', happy:'ğŸ˜ƒ' };
    const emojiContainer = document.getElementById('emojiContainer');
    function clearEmojis(){ emojiContainer.innerHTML = ''; }
    function generateEmojis(mood){
      clearEmojis();
      const char = moodEmojis[mood]||'âœ¨';
      for(let i=0;i<10;i++){
        const span = document.createElement('span');
        span.className = 'emoji';
        span.textContent = char;
        span.style.left = Math.random()*100 + '%';
        span.style.animationDelay = Math.random()*0.5 + 's';
        emojiContainer.appendChild(span);
        setTimeout(()=>span.remove(),3000);
      }
    }

    // 3) Voice loading & picker
    let voices = [];
    function loadVoices(){
      voices = speechSynthesis.getVoices();
    }
    speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();

    function pickVoice(langCode){
      // try exact, then startsWith
      return voices.find(v=>v.lang===langCode)
          || voices.find(v=>v.lang.startsWith(langCode.split('-')[0]))
          || null;
    }

    // 4) Main logic
    const getVerseBtn = document.getElementById('getVerse');
    const container    = document.getElementById('versesContainer');
    const moodSelect   = document.getElementById('mood');

    getVerseBtn.addEventListener('click',()=>{
      const mood = moodSelect.value;
      container.innerHTML = '';
      clearEmojis();

      if(!mood || !mappings[mood]){
        container.textContent = 'Please select a valid mood.';
        container.className = 'verses animate__animated animate__fadeIn';
        return;
      }

      // animate emojis
      generateEmojis(mood);

      // pick a verse and render blocks
      const verse = mappings[mood][Math.floor(Math.random()*mappings[mood].length)];
      ['ar','ur','en'].forEach((lang, idx)=>{
        const block = document.createElement('div');
        block.className = 'verse-block animate__animated animate__fadeInUp';
        block.setAttribute('data-lang-label',
          lang==='ar'?'Arabic':lang==='ur'?'Urdu':'English'
        );
        block.tabIndex = 0;

        const btn = document.createElement('button');
        btn.className = 'play-btn';
        btn.innerHTML = `<span class="sr-only">Play ${lang==='ar'?'Arabic':lang==='ur'?'Urdu':'English'} verse</span>ğŸ”Š`;
        btn.addEventListener('click',()=>{
          const text = verse[lang];
          const utter = new SpeechSynthesisUtterance(text);
          // BCP-47 codes
          const code = lang==='ar'?'ar-SA':lang==='ur'?'ur':'en-US';
          utter.lang = code;
          const voice = pickVoice(code);
          if(voice) utter.voice = voice;
          speechSynthesis.speak(utter);
        });

        const txt = document.createElement('div');
        txt.className = 'verse-text';
        txt.style.fontFamily = lang==='ar'?'Amiri, serif':lang==='ur'?'Jomhuria, cursive':'Roboto, sans-serif';
        txt.textContent = verse[lang];

        block.append(btn, txt);
        container.appendChild(block);
        if(idx===0) block.focus();
      });

      container.style.display = 'flex';
      container.className = 'verses animate__animated animate__fadeIn';
    });
  </script>
</body>
</html>
